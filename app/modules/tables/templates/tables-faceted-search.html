<div class="container-fluid">

  <div class="row">
    <div class="col-md-12">
      <h1 class="main-title">Faceted Search</h1>
      </div>
  </div>


  <div class="row">

    <div class="col-md-2">

      <p>Filters</p>

      <p>Refined by <a class="pull-right" href="" ng-click="faceted.clear()" ng-show="faceted.facetList.length">Clear</a></p>
      <ul class="list-unstyled">
        <li ng-repeat="item in faceted.facetList"><a class="badge" href="">{{item}}</a></li>
      </ul>

      <div>Countries <a class="pull-right" href="" ng-click="faceted.show = !faceted.show"><i class="fa fa-lg fa-angle-right fa-transition" ng-class="{'fa-rotate-90': faceted.show === true}"></i></a></div>

      <div collapse="!faceted.show" class="collapse" style="height: auto;">
        <div class="checkbox" ng-repeat="item in faceted.table.data | unique: 'country' | orderBy: 'country'">
          <label>
            <input type="checkbox" ng-model="faceted.table.search.country[item.country]" ng-click="faceted.checked(faceted.table.search.country[item.country], item.country)"> {{item.country}} (<span>{{item.country | count:'country':faceted.table.data}}</span>)
          </label>
        </div>
      </div>


      <div>Groups <a class="pull-right" href="" ng-click="facetedGroups.show = !facetedGroups.show"><i class="fa fa-lg fa-angle-right fa-transition" ng-class="{'fa-rotate-90': facetedGroups.show === true}"></i></a></div>

      <div collapse="!facetedGroups.show" class="collapse" style="height: auto;">
        <div class="checkbox" ng-repeat="item in faceted.groups">
          <label>
            <input type="checkbox" ng-model="faceted.table.search.group[item]" ng-click="faceted.checked(faceted.table.search.group[item], item)"> {{item}} (<span>{{item | count:'groups':faceted.table.data}}</span>)
          </label>
        </div>
      </div>

      <div>User type <a class="pull-right" href="" ng-click="facetedType.show = !facetedType.show"><i class="fa fa-lg fa-angle-right fa-transition" ng-class="{'fa-rotate-90': facetedType.show === true}"></i></a></div>

      <div collapse="!facetedType.show" class="collapse" style="height: auto;">
        <div class="checkbox" ng-repeat="item in faceted.table.data | unique: 'userType' | orderBy: 'userType'">
          <label>
            <input type="checkbox" ng-model="faceted.table.search.userType[item.userType]" ng-click="faceted.checked(faceted.table.search.userType[item.userType], item.userType)"> {{item.userType}} (<span>{{item.userType | count:'userType':faceted.table.data}}</span>)
          </label>
        </div>
      </div>

      <pre>{{faceted.table.search | json}}</pre>
      <pre>{{faceted.facetList | json}}</pre>

    </div>

    <div class="col-md-9  col-md-offset-1">

      <div class="row toolbar spacer-top-md spacer-bottom-md">


        <div class="col-md-12">

          <form class="form-inline pull-right">

            <div class="form-group dropdown">
              <button type="button" class="btn btn-link dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-fw fa-filter"></i> {{faceted.table.search.country || 'All countries'}} <i class="fa fa-angle-down"></i>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li class="dropdown-header">Country filter</li>
                <li>
                  <a ng-click="faceted.table.search.country = ''">Show all</a>
                </li>
                <li class="divider"></li>
                <li ng-repeat="item in faceted.table.data | unique: 'country' | orderBy:'country'">
                  <a ng-click="faceted.table.search.country = item.country">{{item.country}}</a>
                </li>
              </ul>
            </div>


            <div class="input-group">

              <div class="input-group-addon">
                  <i class="fa fa-fw fa-search"></i>
              </div>

                <input class="form-control search" type="text" placeholder="Search" ng-model="faceted.table.search.$" ng-model-options="{debounce: 300}" required>
                <button class="btn btn-link search-clear" type="reset" ng-click="faceted.table.searchClear()"><i class="fa fa-fw fa-times-circle"></i></button>
            </div>

          </form>

        </div>

      </div>


      <div class="row">

        <div class="col-md-12">

          <table class="table table-datatable table-hover table-border-bottom">
            <thead>
              <tr>
                <th class="nowrap">First Name</th>
                <th class="nowrap">Last Name</th>
                <th>Email</th>
                <th>Country</th>
                <th>Created</th>
                <th>Type</th>
                <th style="width: 300px;">Groups</th>
              </tr>
            </thead>

            <tbody>
              <tr ng-if="!faceted.table.dataFiltered.length">
                <td colspan="9" class="text-center">There are no results.</td>
              </tr>
              <tr ng-click="faceted.table.selectRow(item, $event)"
                  dir-paginate="item in faceted.table.dataFiltered = (faceted.table.data | orderBy:faceted.table.sort.type:faceted.table.sort.reverse | filter: faceted.table.filter | itemsPerPage: faceted.table.paging.size )"
                  ng-class="{'table-row-selected': item.selected}">

                <td>{{::item.first_name}}</td>
                <td>{{::item.last_name}}</td>
                <td><a href="#" ng-click="faceted.table.selectEmail(item, $event)">{{::item.email}}</a></td>
                <td><span class="text-nowrap">{{::item.country}}</span></td>
                <td>{{::item.date.created | date:'MM/dd/yyyy'}}</td>
                <td><i class="fa fa-fw" ng-class="{'fa-user': item.userType === 'user', 'fa-user-secret': item.userType === 'admin'}"></i></td>
                <td>
                  <span ng-repeat="group in (item.groups | orderBy: group | limitTo: item.limit || faceted.table.groups.min) track by $index">
                    {{::group}}<span ng-if="!$last">, </span>
                  </span>
                  <div>
                    <a class="small" href="" ng-if="item.groups.length > faceted.table.groups.min" ng-show="!item.limit" ng-click="faceted.table.showMore(item, true, $event)">Show more</a>
                    <a class="small" href="" ng-show="item.limit" ng-click="faceted.table.showMore(item, false, $event)">Show less</a>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

        </div>

      </div>

      <div class="row toolbar toolbar-footer">

        <div class="col-md-2 col-md-push-5 text-center">
          <form class="form-inline">
            <select class="form-control" ng-model="faceted.table.paging.size" ng-options="size as size for size in faceted.table.paging.sizes"></select> per page
          </form>
        </div>



          <div dir-pagination-controls boundary-links="true" max-size="6" template-url="modules/tables/templates/tables-datatable-dirPaginate.html"></div>



      </div>


    </div>

  </div>

</div>
